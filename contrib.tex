\documentclass{article}
\usepackage[margin=20mm]{geometry}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{unicode}
\usepackage{multicol}

\def\F{\mathbb{F}}
\let\ro\mathcal
\let\fr\mathfrak
\def\abs#1{\left|#1\right|}
\def\pa#1{\left(#1\right)}

\usepackage{xcolor}
\def\XXX{{\colorbox{red}{{\color{white}\bfseries XXX}}}}

\begin{document}
% \begin{multicols}{1}
\sloppy

\XXX TODO:

compter les courbes
twist secure

exemples Microsoft MSR ECLIB, Curve25519, ...

\section{Criteria for cryptographic elliptic curves}
\label{s:criteria}

We give here a list of useful criteria for selecting elliptic curves
for general cryptographic use.

In all the remainder of this section,
we shall use the following notations:
$p$~is a prime number,
$k = \F_{p}$ is the finite field with $p$~elements,
$E: y^2 = x^3 + a\,x + b$~is an elliptic curve defined over~$k$,
$N = \abs{E(\F_p)}$~is the order of the group of rational points of~$E$,
$t = p + 1 - N$~is the trace of the Frobenius automorphism of~$E$,
and $q$~is the largest prime divisor of~$N$.

\subsection{Hardness of the discrete logarithm problem}
\subsubsection{Non-zero discriminant}

If the discriminant~$4\, a^3 + 27\,b^2$
of the curve~$E$ is zero, then $E$~is not an elliptic curve:
it is a singular curve and its group of points is isomorphic to
an additive or multiplicative group.

\subsubsection{Large prime subgroup}

Since discrete logarithms are computable in the group~$E(k)$
with complexity~$O(√q)$, where $q$~is the largest prime divisor of~$N$,
it is necessary that~$√q$ attains the required security bound.
In practice, it is advisable to select elliptic curves whose order~$N$
is the product of a large prime~$q$
and a very small \emph{cofactor}~$N/q$.

For a given curve~$E$, checking if this is the case
requires computing the group order~$N$,
which is a moderately expensive task.

\XXX complexité

\subsubsection{Absence of additive transfer}

If $N = p$ then there exists an \emph{additive transfer}
reducing the discrete logarithm in~$E(k)$
to that in the additive group.

Therefore, elliptic curves with trace~$1$ must be excluded.

\subsubsection{Absence of multiplicative transfer}

The \emph{embedding degree} is the smallest integer~$e$ such that
$q$~divides~$p^e -1$.
The pairing attached to the elliptic curve~$E$
gives a group homorphism from~$E(k)$
to the multiplicative group~$\F_{p^e}^{×}$.

Therefore, elliptic curves with an embedding degree small enough
that discrete logarithms are computable in $\F_{p^e}^{×}$
must be excluded.

\subsection{Resistance to common side-channel attacks}

\subsubsection{Twist security}

The \emph{quadratic twist} of the elliptic curve~$E$
is the curve~$E'$ with equation~$d y^2 = x^3 + a\,x + b$,
where $d$~is a non-square element of~$k$.
For a given abscissa~$x_0$,
exactly one of the curves~$E, E'$ contains a point~$(x_0, y)$.

An attacker can manipulate a protocol into using the twist~$E'$
in place of the original curve~$E$,
either through side-channel attacks~\cite{fdtc2008flrv},
or through man-in-the-middle attack on a badly designed protocol.

If the twist~$E'$ of~$E$ satisfies
the same security conditions as the curve~$E$ itself, then
none of these attacks apply to the curve~$E$.

\subsubsection{Special points}

The \emph{special points} of an elliptic curve
are the points~$(x,y)$ such that one of the two coordinates is zero.
In the presence of such special points,
there exist side-channel attacks~\cite{pkc2003goubin}
exposing private information.

Special points of the form~$(x, 0)$ exist if the curve has
an even order.
Special points of the form~$(0, y)$ exist if the coefficient~$b$
is a square in~$k$.

\subsection{Normality of the curve}

The criteria we present here do not correspond to
known attacks on elliptic curves.
Rather, they are properties that random curves should verify
with overwhelming probability.
When generating curves, checking for these conditions
should involve a negligible number of rejected curves.
On the contrary, if a curve does not satisfy one of these conditions,
then even although we do not know any precise attack,
this curve is slightly more likely to be vulnerable.

Keeping in mind that the discrete logarithm in~$E(k)$
has an expected complexity of~$O(√q)$,
we reject as ``too special'' those curves
which satisfy exceptional properties with probability~$≤ 1/√q$.

\subsubsection{Discriminant and class number}

The \emph{endomorphism field} of the curve~$E$
is the field~$K$ generated by its Frobenius endomorphism~$φ$.
Since $φ$~is a root of the equation~$φ^2 - t φ + p = 0$,
$K$~is an imaginary quadratic number field.
The discriminant of~$φ$ is the value~$D = t^2 - 4 p < 0$;
the discriminant of~$K$ is the fundamental discriminant~$D_0$
such that~$D = D_0 f^2$ for~$f ∈ ℤ$.

The expected value for~$D_0$ is~$D_0 ≈ D$;
we know~\cite{jis2014cdkd} that the square-free part of
a random integer~$n$ is less than~$√n$
with probability approximately~$1.66/√n$.
For cryptographic sizes, this means that,
with overwhelming probability, we should expect~$D_0 > √D$.

The best method we know to compute~$D_0$ requires the
factorization of~$D$.
For cryptographic values of~$D$, this is a possible but
quite expensive task. \XXX
However, since almost all curves satisfy the condition~$D_0 > √D$,
this condition is extremely unlikely to lead to the rejection of a curve
and the computation will therefore be performed only once.

\medbreak

The class number of~$D_0$ is minorated~\cite{cras1990louboutin}
by~$h(D_0) ≥ \frac{π}{3e} \frac{√{\abs{D_0}}}{\log \abs{D_0}}$.

There exists a simple formula~\cite[7.24]{cox1989primes}
relating the class numbers $h(D)$~and~$h(D_0)$.


\subsubsection{Parameters of a special form}

In the case of the \emph{multiplicative} discrete logarithm problem,
the Special Number Field Sieve allows faster computations
of discrete logarithms modulo~$p$
when $p$~is a \emph{special} prime number,
\emph{i.e.} when it is a value of a polynomial with small coefficients.

It is hard to check whether a given prime number is special.
However, most prime numbers used in standard elliptic curves
(for example in the FIPS 186--2 curves \XXX or in Curve25519)
are explictly given as special primes.
Even though we don't know any attack against curves with special parameters,
it is possible that some might exist.

\subsubsection{Normality of the base field}

The multiplicative structure of the base field~$\F_p^{×}$
is directly related to the factorization of~$p-1$.
In particular, if $p-1$~is smooth
(\emph{i.e.} all its prime divisors are small),
then the multiplicative discrete logarithm problem is easy.
We check~\cite{jnt1983cep} that
$(p-1)/2$~is $\pa{\log p}^2$-smooth with probability $1/√p$.
This means that, with overwhelming probability,
for a random number~$p$, we expect that~$(p-1)$
has at least one prime divisor greater than~$(\log p)^2$.

\subsection{Convenience of implementation}

We list here a few criteria that,
may make its implementation more convenient
without weakening the security of the curve itself.
In order to not weaken the ``normality'' of the curves,
we consider only these conditions which are satisfied
by an asymptotically constant proportion of all elliptic curves.

\subsubsection{Coefficient~$a = -3$}

Choosing a curve of the form~$y^2 = x^3 - 3 x + b$
enables to save 2 out of 10 multiplications~\cite{ieeep1363}
required to double a point in Jacobian coordinates.
A random elliptic curve over~$\F_p$
is isomorphic to a curve with~$a = -3$
with probability~$1/2$ if~$p ≡ 3 \pmod{4}$ and~$1/4$ if~$p ≡ 1 \pmod{4}$.

\subsubsection{Number of points at most~$p$}

If the number of points~$N$ is greater than~$p$,
then it might be impossible to represent numbers up to~$N-1$
in the same memory size as coordinates of points of~$E$.
Exactly one half of all curves satisfy this.

\subsubsection{Easy computation of square roots}

The \emph{point compression} method allows representing
one point~$(x,y)$ of~$E$ by only its abscissa~$x$ and
one bit discriminating between the two possible values~$±y$.
However, recovering~$y$ requires computing a square root in~$k$.
This is easier when~$p ≡ 3 \pmod{4}$ since
in this case, $c^{(p+1)/4}$~is a square root of~$c$ if $c$~is a square.

\subsubsection{Equations other than Weierstraß}

There exist several other representations of elliptic curves
than Weierstrass curves, such as
Edwards curves~\cite{ams2007edwards},
twisted Edwards curves~\cite{africa2008bbjl},
Jacobi curves~\cite{aaaaec2003bj},
and Montgomery curves~\cite{mathcomp1987montgomery}.
Only a finite proportion of curves are isomorphic
to a curve in these families.
For example, about~$35\%$ of all elliptic curves
are isomorphic to a twisted Edwards curve,
and about~$40\%$ are isomorphic to a Montgomery curve.
% source: own research

\subsection{Curves with particular properties}

\subsubsection{Curves for pairing-based cryptography}

\subsubsection{Curves with a fast endomorphism}


\section{Transparent generation of curves}

We give here the outlines of a certificate format
proving that a given curve was generated by a public algorithm
from a known seed.

\subsection{Generating an elliptic curve}

This procedure is in two steps.
First, a \emph{generating program} determines a suitable elliptic curve.
This programs outputs the elliptic curve
together with a \emph{certificate} proving that
the curve is actually suitable for cryptographic purposes.
Moreover, the certificate should also prove that
none of the curves previously tried by the generating program
was suitable.
Then, a \emph{validation program} can use the certificate data
to validate the generating process.
The certificate enables this second program
to have a significantly shorter runtime than the first one.

We do not fully specify all the conditions included in the certificate.
For most of the conditions presented in Section~\ref{s:criteria},
checking whether a curve is suitable is very fast.
However, two conditions in particular are more expensive:
namely, the condition that the curve order be prime
(this condition is expected to be the one condition
leading to rejection of all the unsuitable curves,
so that this check will be performed a large number of times),
and the computation of the class number
(which will be performed only once, for the final curve).

\subsection{Certifying the curve order}

Some of the most efficient methods to compute the curve order are
variants of the $ℓ$-adic SEA algorithm~\cite{mathcomp1985schoof,
jtnb1995schoof}.
This algorithm computes the order~$N$ of the curve
by computing $N \pmod{ℓ}$ for several
auxiliary primes~$ℓ < O(\log p)$.

\subsubsection{Prime curve order}
When the algorithm finds that the value~$N$ is prime,
a certificate is as follows: $(N, G, Π)$,
where $N$~is the number of points,
$G$~is a point of order~$N$ (for example, any random non-zero point),
and $Π$~is a proof of primality of~$N$
(which may be left empty if $p$~is small enough
that proving its primality directly is easier than using a certificate).
The validation program then checks that $G ≠ 0$,
$N · G = 0$, and~$N > (√p+1)^2 / 2$.
If this is the case, then $N$~is the curve order.

\subsubsection{Composite curve order}

If the curve order is divisible by one of the auxiliary primes~$ℓ$,
then we detect that~$N ≡ 0 \pmod{ℓ}$ early in the algorithm,
without computing the full value of~$N$.
The SEA algorithm also gives a polynomial~$f$, of degree~$(ℓ-1)/2$,
whose roots are the abscissaes of all $ℓ$-torsion points of~$E$.
We may then recover one of these points by
computing one factor of~$f$ of degree~$1$:
using the Cantor-Zassenhaus polynomial factorization algorithm,
we find that the complexity of this operation
is approximately the same as that of computing~$N \pmod{ℓ}$,
so that computing this extra information
does not significantly slow down the computation of~$N$.

\smallskip

If, on the other hand, the curve order is divisible
by none of the auxiliary primes,
then the SEA algorithm will compute the exact value~$N$.
A simple pseudo-random proof of composition,
such as the Miller-Rabin,
will then suffice to prove that $N$~is composite.

\smallskip

In both cases, it is possible to produce a certificate of composition
of the curve order in the following form: $(N, G, Π)$,
where $N$~is a number such that~$N < 2 (√p - 1)^2$,
$Π$~is a proof of composition of~$N$,
and $G$~is a point of the curve such that~$N G = 0$.
Namely, in the first case, since we know a point~$G$ such that~$ℓ G = 0$,
we may output the certificate~$(2 ℓ, G, Π)$
where $Π$~is a certificate of composition of~$2 ℓ$.


\subsection{Seed choice}


\bibliographystyle{plain}
\bibliography{contrib}
% \end{multicols}
\end{document}
