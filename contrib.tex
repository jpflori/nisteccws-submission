\documentclass[twocolumn,letterpaper,10pt]{article}
\usepackage[margin=26mm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[english]{babel}
\usepackage{microtype}
\usepackage{xspace}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{graphicx}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{unicode}
\usepackage{indentfirst}
\usepackage{hyperref}
\usepackage{fancyhdr}
\hypersetup{colorlinks,urlcolor=[rgb]{.1,.1,.6},
  linkcolor=[rgb]{.5,.0,.2}, citecolor=[rgb]{.2,.0,.4}}

\def\F{\mathbb{F}}
\let\ro\mathcal
\let\fr\mathfrak
\def\abs#1{\left|#1\right|}
\def\pa#1{\left(#1\right)}
\def\acco#1{\left\{#1\right\}}
\DeclareMathOperator\End{End}
\DeclareMathOperator\Cl{Cl}

\def\XXX{{\colorbox{red}{{\color{white}\bfseries XXX}}}}
\def\labelitemi{--}

\fancypagestyle{plain}{%
  \renewcommand{\headrulewidth}{0pt}%
  \fancyhf{}%
}
\pagestyle{empty}

\hypersetup{pdftitle={Diversity and transparency for ECC},%
  pdfauthor={Jean-Pierre Flori and Jérôme Plût and Jean-René Reinhard and Martin Ekerå},%
  pdfsubject={Elliptic Curve Cryptography},%
  pdfcreator={Jean-Pierre Flori and Jérôme Plût and Jean-René Reinhard and Martin Ekerå},%
  pdfproducer={Jean-Pierre Flori and Jérôme Plût and Jean-René Reinhard and Martin Ekerå},%
  pdfkeywords={mathematics} {cryptography} {elliptic curves} {discrete logarithm problem} {security}
 {diversity} {transparency},
}
\def\gitkw$#1:#2${{\small \textbf{#1:} \texttt{#2}}}

\title{Diversity and transparency for ECC}
\author{Jean-Pierre Flori\thanks{Agence nationale de la sécurité des systèmes d'information\newline%
Secrétariat général de la défense et de la sécurité nationale\newline%
51, boulevard de La Tour-Maubourg\newline%
75700 Paris 07 SP}%
\and Jérôme Plût\footnotemark[1]%
\and Jean-René Reinhard\footnotemark[1]%
\and Martin Ekerå\thanks{}}
\date{}

\begin{document}
\sloppy
\maketitle
% \thispagestyle{fancy}\cfoot{}
\lhead{\gitkw $Author:$}
\chead{\gitkw $Id:$}
\rhead{\gitkw $Date:$}
% Introduction <<<1
%<<<2
Generating and standardizing elliptic curves to use them in a cryptographic
context is a hard task.
There have been several attempts to define public elliptic curves
for a general cryptographic use,
such as NIST FIPS 186--2 curves~\cite{nist2000fips186-2},
Brainpool curves~\cite{rfc5639},
SECG curves~\cite{certicom2010sec2},
ANSSI FRP256v1~\cite{jorf2011ce},
Curve25519~\cite{pkc2006bernstein},
and OSCCA SM2~\cite{oscca2010sm2}.
Recent years have seen some distrust cast on previously standardized
curves
and the emergence of the need to standardize new curves.
Different parties have spoken their point of view on the (dis)trust they have
on previously standardized curves whether it is because of
the properties they verify or don't verify
or the process used to generate them.
Such analyses often come with
a list of security and performance/implementation-related criteria
a curve should verify,
and a proposal on how to correctly generate such a curve in a way that can be
trusted~\cite{safecurves,msr2014bcln,brainpool2005,eprint2014brainpool,eprint2013abgr},
together with a proposal of such a correctly generated
curve~\cite{pkc2006bernstein,msr2014bcln,eprint2013abgr}.

\medskip
%<<<2
We believe it is very important that the international standards
do not \emph{a priori} restrict practical uses of ECC
to a single elliptic curve
or to a very small family of related elliptic curves.
Even though no attack might currently be known,
the discovery of a weakness of this particular family
is always a possibility.
% It is therefore important, in the event where such an attack is found,
% that the implementation is flexible enough to be able to
% replace a compromised curve by a safer one.
% Stanardizing only one family of curves seems dangerous to us.
% Even though no attack may be currently known, the sole argument of simplicity
% is not sufficient to put all our eggs in the same basket.
As for the choices of the curves themselves
and given the current state-of-the-art,
some trade-offs between speed and security have to be made.
For example, most of the recently proposed
curves~\cite{pkc2006bernstein,msr2014bcln,eprint2013abgr,oscca2010sm2},
and in particular the NIST standardized curves,
rely on the use of special primes or particular forms of curves to
achieve a very high speed,
but don't attain optimal bit-security.
Moreover, secure implementation of these particular curves
may require some specific precautions against various attacks,
such as side-channel attacks.
Having at least a less speed-optimized but more general-looking curve,
defined over a prime field whose characteristic looks random,
in general Weierstraß form, and with a prime number of points
seems primordial,
especially if the former class of curves gets broken in the future.
For ECC to be trusted and widely adopted, \emph{diversity} is needed.

\medskip
%<<<2
Secondly, even when a curve verifies all common security criteria,
whether it is completely generic, or with a few speed-optimized parameters,
another criterion for inclusion in international standards is that
one should know all the details about how the curve was generated,
and be able to verify that the
generation process actually ended up with the claimed curve
and not anoher one in the same family verifying the same conditions.
Much has been said on this matter~\cite{safecurves,msr2014bcln,eprint2014brainpool,eprint2013abgr},
but as will become clear in the next sections, some arbitrary choices always have
to be made: one has to fix some bounds,
find suitable speed/security trade-offs, and so on.
Therefore, \emph{rigidity} as sometimes advertized~\cite{safecurves} seems illusory
to us.
Nevertheless, \emph{transparency} is achievable and needed for wide adoption of ECC.

\medskip

In this note, we don't make an explicit proposal for an elliptic curve,
but we deal with the following issues.
\\{\bf Security. }
We give a list of criteria that should be satisfied by
a secure elliptic curve.
Although a few of these criteria are incompatible,
we detail what whe think are the best choices for optimal security.
\\{\bf Transparency. }
We sketch a way to generate a curve in a fully transparent way
so that it can be trusted and not suspected to
belong to a (not publicly known to be) vulnerable class.
In particular, since the computational cost of verifying
the output of such a process may be quite high,
we sketch out the format of a \emph{certificate} that eases the computations.
We think that this format might deserve being standardized.

\section{Criteria for cryptographic elliptic curves}
\label{s:criteria}
%<<<2
We give here a list of useful criteria for selecting elliptic curves
for general cryptographic use.
We sort these conditions in several categories,
with different importance being granted to each category.
The first category~(\ref{ss:dlp}) contains the minimal conditions under which
the discrete logarithm problem may be hard in the point group.
The second category~(\ref{ss:side}) describes some properties that
may improve security for some implementations,
particularly in a context where side-channel attacks must be considered.
The third one~(\ref{ss:normal}) is not related to any known attack;
instead, it gives condition under which a curve may be considered
as particular and therefore potentially particularly vulnerable
to some yet-unknown attack.
Finally, the last two categories group some properties
which may be desirable about the curve,
either for facilitating its implementation~(\ref{ss:convenience})
or for specific protocols and algorithms~(\ref{ss:particular}),
without weakening (too much) its security.

\bigbreak

\subsection*{Incompatible conditions}
We point out that several of these conditions are mutually incompatible.
We list these here, in a roughly descending order of importance.

\paragraph{Choice of the cardinality of the base field
and the curve coefficients.}
These may either be chosen pseudo-randomly~%
\cite{rfc5639,jorf2011ce}, for example
as a precaution against some side-channel attacks~(\ref{sss:special-side})
or against some possible future attacks~(\ref{sss:special-anormal});
or very specific values may be chosen instead,
in view of faster curve arithmetic~(\ref{sss:special-fast})~%
\cite{nist2000fips186-2,pkc2006bernstein,oscca2010sm2}.

\paragraph{Cofactor.}
While the existence of a very small torsion subgroup
may lead to some attacks such as
small-subgroup attack~(\ref{sss:small-subgroup})
or side-channel attacks~(\ref{sss:special-points}),
it is a necessary condition for the availability
of some faster curve coordinates
such as Edwards or Montgomery curves~(\ref{sss:other-eq}).

\paragraph{Primality of the order of the quadratic twist.}
In general, we expect that the order of the quadratic twist
will have at least one large prime divisor,
for example larger than~$p^{1/4}$ (\ref{sss:normal-twist}).
If this order is itself a prime number,
then this grants a supplementary layer of protection
against some side-channel attacks (\ref{sss:twist}).
However, this property is relatively rare itself
(by a factor proportional to~$\log p$),
which could raise concern that
curves with a prime twist are themselves exceptional in some way.

\medskip

Because of all these incompatibilities,
each implementation might select an appropriate curve
depending on the context,
such as performance constraints or the likelihood of side-channel attacks.
In particular, we think that
international standards should include a family of curves
where each of these contradictions is solved in a way
that maximizes security:
namely, curves with pseudo-random coefficients,
defined over a pseudo-random base field,
with a cofactor equal to one, and preferably with a secure quadratic twist.

\subsection*{Restriction to prime fields}
We limit our discussion to elliptic curves defined over a prime field.
In the case of extension fields,
some attacks exist in particular
cases~\cite{jc2013jv,rsa2004mtw,asia1999dgm,jc2002ghs}.
Some of these attacks may even be exploited
to include a trapdoor in an elliptic curve~\cite{jc2006teske}.
We also note that, over finite fields with small characteristic,
an index calculus technique related to that of~\cite{jc2013jv}
gives a quasi-polynomial solution to
the multiplicative discrete logarithm problem~\cite{euro2014bgjt}.
For all these reasons, we consider elliptic curves over prime fields
as probably much safer than elliptic curves over extension fields.

% We consider the base field itself as one of the parameters
% of the elliptic curve.
% We believe that the safest case is that of a pseudo-random prime
% number~(\ref{sss:special-anormal}).
% \XXX


\subsection*{Notation}
In all the remainder of this document,
we shall use the following notation:
$p ≥ 5$~is a prime number,
$k = \F_{p}$ is the finite field with $p$~elements,
$E: y^2 = x^3 + a\,x + b$~is an elliptic curve defined over~$k$,
$N = \abs{E(\F_p)}$~is the order of the group of rational points of~$E$,
$t = p + 1 - N$~is the trace of the Frobenius automorphism of~$E$,
and $q$~is the largest prime divisor of~$N$ and $c = N/q$ the cofactor.

%>>>2
\subsection{Hardness of the discrete logarithm problem}
\label{ss:dlp}

We give here a list of conditions corresponding to
known attacks on the discrete logarithm problems.
We point out that some criteria commonly required
for generating elliptic curves,
such as the criteria on the discriminant and class number~\cite{rfc5639},
are not known to lead to a direct attack.
Therefore, we do not include them here,
but in Section~\ref{ss:normal} instead.
% Nonetheless, a randomly chosen curve will satisfy the
% criteria usually edicted for these values with overwhelming probability.
% That is, a “normal” curve in the sense of Section~\ref{ss:normal}
% will satisfy such criteria and will not be affected by yet-unknown
% attacks relying on these values being exceptionnally small.
% To conclude, the omission of these criteria here is not problematic.


\subsubsection{Nonsingular curve}
\label{sss:singular}

If the discriminant~$4\, a^3 + 27\,b^2$
of the curve~$E$ is zero, then $E$~is not an elliptic curve:
it is a singular curve and its group of points is isomorphic to
an additive or multiplicative group.
Such (non-elliptic) curves must be excluded.

\subsubsection{Large prime subgroup}
\label{sss:prime}

Since discrete logarithms are computable in the group~$E(k)$
with complexity~$O(√q)$, where $q$~is the largest prime divisor of~$N$,
it is necessary that~$√q$ attains the required security bound.
In practice, it is advisable to select elliptic curves whose order~$N$
is the product of a large prime~$q$
and a very small \emph{cofactor}~$c = N/q$.
A cofactor $c = 1$ yields an optimal security for a given bitsize
whereas a very small cofactor might allow performance improvements.

For a given curve~$E$, checking if this is the case
requires computing the group order~$N$,
which is a moderately expensive task.
For curves over large prime fields,
the most efficient algorithms are variations
of the SEA algorithm~\cite{mc1985schoof,
jtnb1995schoof,smf2008cl} with complexity~$O(\log(q)^4)$.

The probability that a random elliptic curve over~$\F_p$
has a prime group order is bounded below~\cite{lms2000gm}
by $\frac{0.44}{\log p}$.
This condition is the most restrictive during the generation
of a curve in practice.

\subsubsection{Absence of additive transfer}
\label{sss:anomalous}

If $N = p$ then there exists an \emph{additive transfer}
reducing the discrete logarithm in~$E(k)$
to that in the additive group of~$\F_p$.
Therefore, elliptic curves with trace~$1$ must be excluded.

\subsubsection{Absence of multiplicative transfer}
\label{sss:embedding-degree}

The \emph{embedding degree} is the smallest integer~$e$ such that
$q$~divides~$p^e -1$
(that is the multiplicative order of~$p$ modulo~$q$).
The pairings attached to the elliptic curve~$E$
give a group homorphism from~$E(k)$
to the multiplicative group~$\F_{p^e}^{×}$.

Therefore, elliptic curves with an embedding degree small enough
that discrete logarithms are computable in $\F_{p^e}^{×}$
must be excluded.

Over the base field~$\F_p$, supersingular curves
have an embedding degree~one and must be excluded.
They are exactly the curves with trace zero
and can therefore easily be detected.

\subsubsection{Index calculus}

Index calculus techniques developed to compute discrete logarithms
in multiplicative subgroups of finite fields
have been extended to elliptic curves in a variety of ways.
However, in the current state-of-the-art, when the curve is defined over
a prime field, it is more expensive
to correctly lift the curve and the points defining the DLP than
to directly solve it~\cite{asia1998ss,dcc2000silverman,dcc2000ksst,ecc2007silverman,sac2008silverman}.
Therefore, do not believe that there is any additional check to perform
in the case of a prime base field.

\subsection{Implementation-dependent security}
\label{ss:side}

While the existence of some attacks,
such as side-channel attacks or attacks against badly designed protocols,
mainly depends upon the implementation,
in some circumstances the choice of the curve itself
might have an impact on the efficiency of these attacks
or on the ease of implementation of appropriate counter-measures.
We give here a list of criteria
which might improve the security
of some implementations.

\subsubsection{Absence of small subgroups}
\label{sss:small-subgroup}

If the point group contains a small subgroup,
then it may be possible to trick some implementations
into revealing information about the secret key~\cite{crypto1997ll}
or compromising the output of a key exchange.
If the curve does not have a small subgroup
(for example if it has a prime number of points)
then such attacks are inoperant.
Otherwise, protecting against them requires a few more point operations.

\subsubsection{Absence of special points}
\label{sss:special-points}

The \emph{special points} of an elliptic curve
are the points~$(x,y)$ such that one of the two coordinates is zero.
In the presence of such special points,
there exist side-channel attacks~\cite{pkc2003goubin}
exposing private information.

Several protections against these attacks exist~\cite{ches2004mmm}.
One of them is simply ensuring that the curve does not contain
any special point.

Special points of the form~$(x, 0)$ exist if the curve has
an even order.
Special points of the form~$(0, y)$ exist if the coefficient~$b$
is a square in~$k$.

\subsubsection{Twist security}
\label{sss:twist}

The \emph{quadratic twist} of the elliptic curve~$E$
is the curve~$E'$ with equation~$d y^2 = x^3 + a\,x + b$,
where $d$~is a non-square element of~$k$.
For a given abscissa~$x_0$,
exactly one of the curves~$E, E'$ contains a point~$(x_0, y)$.

An attacker may manipulate a badly written implementation
into using the quadratic twist~$E'$
in place of the original curve~$E$,
either through side-channel attacks~\cite{fdtc2008flrv},
or through attacks on a badly designed protocol.

Such attacks may be easily mitigated by checking
that the manipulated points are on the original curve~$E$
and not on its twist~$E'$.
A supplementary layer of protection against these attacks
can be obtained if the twist~$E'$ satisfy
security conditions similar to those of the curve~$E$ itself.
Nevertheless, it should be noted that the original curve and
its twist will never share the same exact behavior against
side-channel attacks, e.g. for exactly one of the two curves the coefficient $b$
is a square, which is suboptimal against side channel attacks
as the curve contains a special point of the form~$(0, y)$.
Moreover twist security won't protect against potential side channel attacks
where one would detect if the computation took place on the curve or its twist
and gain information on some bits of the secret.

Using a variant of the technique of Galbraith and McKee~\cite{lms2000gm},
we find that the probability that a random elliptic curve on~$\F_p$
is both secure and twist-secure
seems bounded below by $\frac{0.5}{\log^2 p}$
and above by~$\frac{5}{\log^2 p}$.
This estimate means that
including twist-security in the conditions is particularly expensive,
since all necessary checks will be performed on
a quadratic (in $\log p$) number of elliptic curves.
In particular, in view of
the certificates mentioned in Section~\ref{s:certif},
both the size and the cost of validation of the certificate
increase by a linear factor.
Although this property of twist-security is quite rare,
the curves satisfying it are not special
in the sense of Section~\ref{ss:normal}.

\subsubsection{Non-special base field}
\label{sss:special-side}

Some common parameter choices,
such as the NIST elliptic curves~\cite{nist2000fips186-2},
use as their base field a prime field~$\F_p$
where $p$~is a prime number of a ``special form'',
such as pseudo-Mersenne or generalized Mersenne numbers
or values of cyclotomic polynomials~\cite{mc2013gm}.
While the use of such prime numbers speeds up the modular arithmetic,
they are also more vulnerable to some side-channel attacks%
~\cite{ches2005dkj,ics2005ss,ches2014bpsy,eprint2014-434,ieice2006ss,indo2014frv}.
The use of a non-special, pseudo-random base field
prevents this class of attacks.

\subsubsection{Unified group law}
\label{sss:unified}

Some curve families admit a \emph{unified} or \emph{complete}
addition law: these formulas have no exceptional cases
such as~$P + P$, $P + (-P)$ or~$P + 0$ for Weierstraß curves.
When using such formulas, a point multiplication
is computed in constant time relatively to the scalar,
which adds a layer of protection against some side-channel attacks.
However, this does not offer an absolute protection~\cite{indo2014frv}.
Moreover, these families all have a non-trivial cofactor,
which could be considered as a threat
in light of~\ref{sss:small-subgroup} or~\ref{sss:special-points} above.

\subsection{Normality of the curve}
\label{ss:normal}

% Intro%<<<
The criteria we present here do not correspond to
known attacks on elliptic curves.
Rather, they are properties that random curves should verify
with overwhelming probability.
When generating curves, checking for these conditions
should reject a negligible proportion of curves.
If on the other hand a curve does not satisfy one of these conditions
then, even though we do not know any precise attack,
this curve is slightly more likely to be vulnerable.

More concretely this means that during the process of generating
a secure curve, in general, curves will be discarded
because they don't verify one of the criteria of Section~\ref{ss:dlp}.
When a curve passes the checks for the latter criteria,
the computations needed for the criteria of the current section
will be performed and will also pass with overwhelming probability.
Therefore, these computations will only be performed once in general,
on the final curve.
%>>>
\medbreak\par\textit{Expected smoothness of random numbers.} %<<<
Many common number-theoretic computations depend on
the factorization of a parameter (for example, the order of some group),
and become easier when this parameter is smooth
(\emph{i.e.} when it has only small prime divisors).
We recall here~\cite{jnt1983cep} that the probability that
a number~$n$ be~$B$-smooth is approximately~$u^{-u}$,
where $u ≃ \log n / \log B$.

We must determine a threshold at which the factorization of these
numbers is considered ``too smooth''.
The first choice for a probability threshold would be
of the order of~$1/√p$, corresponding to the complexity of
the discrete logarithm in the group~$E(k)$.
% For example, for a fixed exponent~$α$,
% a number~$x ≈ p^{α}$ only has a probability~$≈ 1/√p$
% of being~$(\frac{\log p}{2\log\log p})^{2α}$-smooth.
However, numeric computations suggest that this choice may be too lenient:
for random numbers of 256~bits, the threshold probability of~$2^{-128}$
corresponds to numbers which are~$727$-smooth.
In a computational view, this bound is extremely low:
any algorithm involving polynomials or matrices of this size
would be easy to implement.
We instead use the smoothness bound~$B = p^{1/4}$,
corresponding to a probability of~$1/256$.
This means that we expect that only
$1/256$~of pseudo-random elliptic curves
will be rejected as ``too exceptional'',
while computations in these groups
are likely to involve linear or polynomial algebra
with size about~$p^{1/4}$,
which will likely remain out of reach for reasonable values of~$p$.

% We could instead balance the smoothness bound~$B = n^{1/u}$
% such that the probability of smoothness~$u^{-u}$ is~$1/B$.
% Using this estimate,
% we could say that
% a random number of $256$~bits should not be $2^{28}$-smooth
% and that a random number of $512$~bits should not be $2^{42}$-smooth.
% We think that more research is needed on this subject.
%>>>
\subsubsection{Discriminant of the endomorphism ring}
\label{sss:discriminant}

% If the number of points of~$E$ is prime,
% then its endomorphism ring is the maximal order~$\ro O_K$ of~$K$.
% preuve:
% sinon, il existe deux courbes isogènes ψ: E → E' ayant des anneaux
% d'endomorphismes distincts. Par conséquent, il existe un nombre premier
% ℓ≠N divisant f'/f (ou f/f' si on veut). L'isogénie ψ est donc
% (non_horizontale) sur le ℓ-volcan. Par conséquent, elle modifie la
% structure de groupe de E(k) ⊗ ℤ_ℓ, i.e. son noyau contient un groupe
% d'ordre ℓ. Or, puisque N est premier, E(k) ne contient aucun tel
% sous-groupe. ⚡


The \emph{endomorphism field} of the curve~$E$
is the field~$K$ generated by its Frobenius endomorphism~$φ$.
Since $φ$~is a root of the equation~$φ^2 - t φ + p = 0$,
$K$~is an imaginary quadratic number field.
The discriminant of~$φ$ is the value~$D_φ = t^2 - 4 p < 0$.
It is the discriminant of the order $\ro O_φ = ℤ[φ] \subset K$.
The discriminant of~$K$ is the (fundamental) discriminant~$D_K$ of its
maximal order $\ro O_K$.
It is closely related to the square-free part of $D_φ$:
$D_φ = D_K f_φ^2$ for~$f_φ ∈ ℤ$
called the conductor of the order $\ro O_φ$,
and $D_K$ or~$D_K/4$ is a square-free integer.
The \emph{endomorphism ring} of the curve~$E$ is some order $\ro O_E$ in $K$:
$\ro O_φ \subset \ro O_E \subset \ro O_K$.
Let us denote its discriminant by $D_E$.
Note that if $E$ has prime order, then $\ro O_E = \ro O_K$.
More generally, if a prime $ℓ$ divides the conductor $f_E$ of $\ro O_E$,
then it must divide the cardinality $N$ of $E$.
Therefore, if the cofactor $c$ in $N$ is very small, a necessary condition for
cryptographic use, then $\ro O_E$ should be close to $\ro O_K$ but
in exceptional cases, and we focus on the case where $\ro O_E = \ro O_K$
which is sufficient for prime-order elliptic curves.
This treatment can be extended provided the order $\ro O_E$ is computed.
The best method we know to compute~$\ro O_E$ for an ordinary elliptic curve
is of subexponential complexity~\cite{jmc2012bisson}.

The expected value for~$D_E$ is~$D_K ≈ D_E ≈ D_φ$;
we know~\cite{jis2014cdkd} that the square-free part of
a random integer~$n$ is less than~$√n$
with probability approximately~$1.66/√n$.
For cryptographic sizes, this means that,
with overwhelming probability, we should expect~$D_K \geq D_E > √{D_φ}$.

The best method we know to compute~$D_K$ requires the
factorization of~$D_φ$ and is therefore of subexponential complexity.
For cryptographic values of~$D_φ$, this is a possible but
quite expensive task.
However, since almost all curves satisfy the condition~$D_K > √{D_φ}$,
this condition is extremely unlikely to lead to the rejection of a curve
and the computation will therefore in practice be performed
only once for the final curve.
Moreover, once the factorization of~$D_φ$ is known,
it is very easy to check that the produced
factorization is correct.

It should be noted that this criteria automatically eliminates
the two smallest discriminants~$D_K = -4$ and~$D_K = -3$,
corresponding to the special curves with $j$-invariant~$1728$ or~$0$.

\subsubsection{Class number and class group}
\label{sss:class-group}

The class number~$h(\ro O_E)$ of the order~$\ro O_E$
is the minimal degree of a number field
over which $E$~admits a faithful lift.
It is also the degree of the Hilbert class polynomial
used in the theory of complex multiplication.
Therefore, a large class number may prevent the use
of any attacks based on complex multiplication.
Under the generalized Riemann hypothesis,
the best method we know to compute the class number
is subexponential~\cite{ams1989hmc,chile2009biasse},
and requires at least a few days of computation for cryptographic sizes.
Since this method also computes the group stucture
of the ideal class group of~$\ro O_E$,
it can be used to produce a small and easily verifiable certificate
for the class number.
Note that the value $h(\ro O_E)$ is easily computed~\cite[7.24]{cox1989primes}
as a multiple of the more classical class number~$h(K)$
of the maximal order~$\ro O_K$ in $K$
which is therefore enough to work with.

% It is related to the class number~$h(\ro O_K)$ of the maximal order
% by a simple formula~\cite[7.24]{cox1989primes}:
% if $R$~is the order of conductor~$f$, then
% $h(R) = h(\ro O_K) f ∏ (1 - \pa{\frac{D_K}{p}}/p)$
On the other hand,
the class number of~$K$ is minorated~\cite{cras1990louboutin},
under the generalized Riemann hypothesis,
by~$h(K) ≥ \frac{π}{3e} \frac{√{\abs{D_K}}}{\log \abs{D_K}}$.

\medbreak

The class number has a negligible probability
of being~$(\log p)^{1-o(1)}$-smooth.
While the best known algorithms for computing the class number
are sub-exponential~\cite{ams1989hmc,chile2009biasse},
for any bound~$B$,
it is possible to prove that $h$~is not $B$-smooth
in time~$O(B \log p)$,
which is polynomial if $B$~is polynomial.
% it is possible to prove in polynomial time that $h$~is not $B$-smooth in polynomial time.
% Namely, for each prime~$ℓ < B$, let~$e(ℓ)$ be
% the smallest integer such that~$ℓ^{e(ℓ)} > h$;
% and define~$M$ as the product of all~$ℓ^{e(ℓ)}$.
% Since~$h = O(√p)$, we see that~$\log M ≈ \frac{B}{2 \log B} \log p$.
% If $h$~is $B$-smooth, then all elements of the class group~$\Cl K$
% have $M$-torsion.
% Therefore, any element~$g$ of the class group such that~$M g ≠ 0$
% proves that $h$~is not $B$-smooth.
% Since we expect that $\Cl K$~is almost cyclic,
% in general we need to check this for only one element~$g$.
% The number of multiplications required in~$\Cl K$
% is approximately~$\log M ≈ O(\log^2 p)$.


\subsubsection{Cardinality of the quadratic twist}
\label{sss:normal-twist}

The order of the quadratic twist of~$E$ is~$2(p+1) - N$.
This number lies in the same interval~$[p+1-2√p, p+1+2√p]$
as the curve order itself,
and therefore also as a probability about~$u^{-u}$
of being~$p^{1/u}$-smooth, for~$u > 0$;
for example, it has probability~$1/256$ of being~$p^{1/4}$-smooth.

We recall from paragraph~\ref{sss:twist} above
that the smoothness of this number has a direct influence
on the effectiveness of some side-channel attacks.

It should be noted that the curve and its quadratic twist
share the same endomorphism ring.
Therefore the discriminant and class number criteria
are automatically satisfied by the twist
if they are satisfied by the original curve.
This is not true as far as the embedding degree is concerned.
The original curve and its twist have distinct embedding degrees.

\subsubsection{Non-special base field}
\label{sss:special-anormal}

In the case of the \emph{multiplicative} discrete logarithm problem,
the Special Number Field Sieve allows faster computations
of discrete logarithms modulo~$p$
when $p$~is a \emph{special} prime number,
\emph{i.e.} when it is a value of a polynomial of low degree
with small coefficients evaluated at a small value.

It is hard to check whether a given (prime) number is special.
However, most prime numbers used in standard elliptic curves
(for example in the FIPS 186--2 curves~\cite{nist2000fips186-2},
in Curve25519~\cite{pkc2006bernstein},
and in the SM2 curve~\cite{oscca2010sm2})
are explictly given as special primes as these allow faster arithmetic
over the base field.
Even though we don't know any attack against curves with such special
parameters, it is legitimate to consider them as exceptional.

A related question would be to detect curves whose number of points $N$
is a special number.
As noted above, this cannot be easily checked.
Nonetheless, the only way we are aware of which could lead to the construction
of such a curve would be through the use of complex multiplication.
Therefore, the discriminant of the number field associated
to the generated curve would be unusually small and this would be detected by
other checks from this section.

\subsubsection{Embedding degree}

For any bound~$m$, the probability that
the embedding degree (\ref{sss:embedding-degree}) of~$E$ is at most~$m$
is~\cite{jc1998bk} $O(m^2 · p^{-1}·(\log p)^5·(\log\log p)^2)$.
This implies that, with probability~$1 - 1/√p$,
the embedding degree of~$E$ is at least~$p^{1/4 - o(1)}$.

\subsubsection{Multiplicative group of the base field}

The multiplicative structure of the base field~$\F_p^{×}$
is directly related to the factorization of~$p-1$.
In particular, if $p-1$~is smooth
(\emph{i.e.} all its prime divisors are small),
then the multiplicative discrete logarithm problem is easy.
Let~$B$ be a smoothness bound: then, with~$u = \log p / \log B$,
$(p-1)$~is $B$-smooth with probability~$≈ u^{-u}$~\cite{jnt1983cep}.
This means that, with overwhelming probability,
$(p-1)$~has at least one prime divisor greater than~$(\log p)^2$.

\subsection{Convenience of implementation}
\label{ss:convenience}

We list here a few criteria that
may make thee implementation of
an elliptic curve more convenient
without weakening the security.
We note that some of these conditions
(namely \ref{sss:a=-3}, \ref{sss:few-points},
\ref{sss:easy-sqrt} and \ref{sss:other-eq}) are satisfied
by an asymptotically non-zero proportion of all elliptic curves:
in this case, we believe it very unlikely
that such a wide class of curve would be inherently weak
against a future attack.
However, the last two conditions (\ref{sss:special-fast} and
\ref{sss:special-coeff}) correspond to choices that
contradict some conditions from sections~\ref{ss:side}
and \ref{ss:normal} above.

\subsubsection{Fast Jacobian coordinates}
\label{sss:a=-3}

Choosing a curve of the form~$y^2 = x^3 - 3 x + b$ (that is with $a=-3$)
enables to save 2 out of 10 multiplications~\cite{ieeep1363}
required to double a point in Jacobian coordinates.
A random elliptic curve over~$\F_p$
is isomorphic to a curve with~$a = -3$
with probability~$1/2$ if~$p ≡ 3 \pmod{4}$ and~$1/4$ if~$p ≡ 1 \pmod{4}$.

\subsubsection{Number of points at most~\texorpdfstring{$p$}{p}}
\label{sss:few-points}

If the number of points~$N$ is greater than~$p$,
then it might be impossible to represent numbers up to~$N-1$
in the same memory size as coordinates of points of~$E$.
Exactly one half of all curves satisfy this.

\subsubsection{Easy computation of square roots}
\label{sss:easy-sqrt}

The \emph{point compression} method allows representing
one point~$(x,y)$ of~$E$ by only its abscissa~$x$ and
one bit discriminating between the two possible values~$±y$.
However, recovering~$y$ requires computing a square root in~$k$.
This is easier when~$p ≡ 3 \pmod{4}$ since
in this case, $c^{(p+1)/2}$~is a square root of~$c$ if $c$~is a square.
(Similar formulas exist as soon as~$p \neq 1 \pmod{8}$.)

\subsubsection{Equations other than Weierstraß}
\label{sss:other-eq}

There exist several other representations of elliptic curves
than Weierstraß coordinates, such as
Edwards curves~\cite{ams2007edwards},
twisted Edwards curves~\cite{africa2008bbjl},
Jacobi curves~\cite{aaaaec2003bj},
and Montgomery curves~\cite{mc1987montgomery}.
Only a finite proportion of curves are isomorphic
to a curve in these families.
For example, about~$35\%$ of all elliptic curves
are isomorphic to a twisted Edwards curve,
and about~$40\%$ are isomorphic to a Montgomery curve~\cite{sac2011plut}.

Each of these families requires at least
the presence of a point of order two on the curve.
This is a special point in the sense of~\ref{sss:special-points} above
and could introduce a weakness in some implementations.
The corresponding automorphisms also speed up the Pollard rho
method for discrete logarithms by a small factor~\cite{moc2000glv}.
Moreover, in the case of a non-prime base field,
there exist some attacks~\cite{jc2014fghr}
against several of these curve families
which slightly weaken the discrete logarithm problem.

\subsubsection{Fast base field arithmetic}
\label{sss:special-fast}

The choice of a base field of a special form,
such as the field of integers modulo
a pseudo-Mersenne~\cite{pkc2006bernstein}
or generalized Mersenne prime~\cite{nist2000fips186-2},
allows the implementation of a faster, dedicated arithmetic.

However, taking full advantage of these optimizations
needs restricting the implementation to a particular, very small
family of elliptic curves.
Therefore, we think that, for optimal security and in view of
paragraphs~\ref{sss:special-side} and~\ref{sss:special-anormal} above,
the most secure implementations should be able to work with
a general base field.

\subsubsection{Special coefficients}
\label{sss:special-coeff}

Most of the formulas for elliptic curve arithmetic
involve the use of the curve coefficients.
Choosing special values for these coefficients,
such as integers with a small absolute value,
allows a faster implementation.

However, as in the previous paragraph, we think that
restricting implementation to benefit from these optimizations
might be a security threat.

\subsection{Families of curves with particular properties}
\label{ss:particular}

We give here a short list of families of curves
with particular properties which might be useful in some specific contexts.
These families are small enough
to contradict the ``normality'' conditions of Section~\ref{ss:normal}.

\subsubsection{Curves with a fast endomorphism}

Some families of curves have an easily computable endomorphism.
This allows a faster implementation of point multiplication%
~\cite{crypto2001glv,joc2011gls}, with a theoretical gain of up to 50\%.

However, the construction of all these families
relies on the fact that the discriminant
of the endomorphism field is small~\cite{asia2013smith},
and is therefore in contradiction with paragraph~\ref{sss:discriminant}.

Moreover, in the presence of an endomorphism of order~$m$,
the Pollard rho method for computing discrete logarithms
becomes faster by a factor of up to~$√m$~\cite{asia1999dgm,moc2000glv}.

\subsubsection{Pairing-friendly curves}
\label{sss:pairing}

Some families of elliptic curves allow a fast pairing computation.
This construction has various applications in cryptography,
such as one-round three-way key exchange~\cite{jc2004joux},
short signatures~\cite{jc2004bls},
and identity-based cryptography~\cite{crypto2001bf,el2002paterson}.

The main requirement for the existence of a fast pairing
is that the embedding degree is small.
This is in direct contradiction with
the requirement from paragraph~\ref{sss:embedding-degree} above.

Moreover, most of the constructions
for pairing-friendly curves~\cite{jc2010fst,space2014em}
either use very sparse families of curves,
or use complex multiplication to construct adequate curves,
which requires a small class group,
in contradiction with paragraph~\ref{sss:class-group}.

\section{Transparent generation of curves}
\label{s:certif}

The selection of an elliptic curve for cryptographic purposes
involves checking a long list of properties,
including several for which arbitrary bounds have to be set:
such as the threshold at which we consider the class number
to be exceptionally small,
or the order of the twisted curve to be exceptionnally smooth.
This implies that the generated curve
will always depend on arbitrary choices,
including the choice of the sampling function for elliptic curves.
That is why we think \emph{rigidity} as often advertized~\cite{safecurves}
is illusory, and we prefer the notion of \emph{transparency}.

We point out that the standard parameters for ECC
include not only the curve, but also its definition field
and a point generating a prime-order group in the curve.
While we know of no weakness related to the choice of this point,
precaution still commands that this choice should also be justified.


Checking that the generation process,
with a known algorithm and a public seed,
indeed produced the claimed curve
is a computationnally expensive task.
We give here the outlines of a certificate format for this.
This allows any program receiving elliptic curve parameters
for cryptographic purposes
to check, at a moderate computational cost,
that the curve is indeed suitable,
and moreover, that it is the first suitable curve
found by the sampling function.

\subsection{Generating an elliptic curve}

This procedure is in two steps.
First, a \emph{generation program}
checks elliptic curves, as provided by a \emph{sampling function},
until a suitable elliptic curve is found.
This programs outputs the elliptic curve parameters
together with a \emph{certificate} proving that
the curve is actually suitable for cryptographic purposes.
Moreover, the certificate should also prove that
none of the curves previously tried by the generating program
was suitable.
Then, a \emph{validation program} can use the certificate data
to validate the generating process.
The certificate enables this second program
to have a significantly shorter runtime than the first one.

The list of conditions to be checked and the way to sample
curve parameters would be indicated in the certificate header.
We do not fully specify how every condition presented
in the previous sections should be written down in the
certificate when it leads to the rejection of a curve.
For most of the ones presented in Section~\ref{s:criteria},
checking whether a curve is suitable is very fast.
% XXX ?
However, three conditions in particular are more expensive:
namely, the condition that the curve order is prime or
only includes the expected small cofactor
(this condition is expected to be the one condition
leading to rejection of most of the unsuitable curves,
so that this check will be performed a large number of times),
the computation of the endomorphism ring and class number,
and the computation of the embedding degree
(both of which will typically be performed only once, for the final curve).

\subsection{Certifying the curve order}

The most restrictive condition in practice is that
the curve order must be prime, or a prime number
times a very small cofactor.
This means that we expect that a linear number (in $\log p$)
of curves will be rejected because of a composite group order,
whereas the first curve found with a prime group order
will be retained.

\subsubsection{Rejected curve order}

In general, proving that the curve order,
is not prime, or has a too large cofactor, is easy:
namely, if $n < 2 (√p-1)^2$ is a composite number coprime to~$c$
and $P ≠ 0$~is a point such that~$n · P = 0$,
then the curve order~$N$ has a composite factor coprime to~$c$.
Namely, let~$d = \gcd (n, N)$; $d$~is coprime to~$c$.
Since~$P≠0$, we have~$d≠1$.
If~$d = N$ then $N$~divides~$n$ and is coprime to~$c$.
Since $n/2$~exceeds the lower Hasse bound~$(√p-1)^2$,
we see that~$N = n$, and therefore $N$~is composite.
If on the other hand~$d ≠ N$, then $d$~is a strict divisor of~$N$.

The certificate is then the list~$(N/c, a, c · G)$,
where $N$~is the computed curve order, $c$~is the cofactor,
$a$~is a witness of composition of~$N/c$,
and $G$~is a random point (such that~$c · G ≠ 0$).

\smallskip

However, in practice, over a prime base field,
the most efficient methods to compute the curve order are
variants of the $ℓ$-adic SEA algorithm~\cite{mc1985schoof,
jtnb1995schoof,smf2008cl}.
This algorithm computes the order~$N$ of the curve
by computing $N \pmod{ℓ}$ for several
auxiliary primes~$ℓ < O(\log p)$.
The fact that $N$~is composite may therefore be detected
in an early step,
when there exists~$ℓ$ (not dividing an allowed cofactor $c$)
such that $N ≡ 0 \pmod{ℓ}$.

It is also possible to benefit from this early detection
while still producing a proof of composition for the order of~$E$.
Namely, if $N ≡ 0 \pmod{ℓ}$ then
the counting algorithm finds a polynomial~$f$, of degree~$(ℓ-1)/2$,
whose roots are the abscissae of points of order~$ℓ$ of~$E$.
We may then recover one of these points by
computing one factor of~$f$ of degree~$1$:
using the Cantor-Zassenhaus polynomial factorization algorithm,
we find that the complexity of this operation
is approximately the same as that of computing~$N \pmod{ℓ}$,
so that computing this extra information
has a small impact on computation time.

The certificate in this case is the list $(ℓ, P)$,
where $P$~is a point of order~$ℓ$.\footnote{%
It is also possible, although slightly less efficient,
to conform to the preceding certificate format
by using the list~$(2 ℓ, 2, P)$,
since $a = 2$~is a witness of composition for~$2ℓ$.}

We also note that, if the list of conditions
include the primality of the twisted curve,
then both methods above should be used
simultaneously for the curve and its quadratic twist.
% \smallskip
% 
% In the other, “late” case, the curve order is not divisible
% by any of the auxiliary primes (but the ones expected if
% a small cofactor was allowed).
% The counting algorithm will then compute the exact value~$N$.
% A simple pseudo-random proof of composition,
% such as the Miller-Rabin test,
% will then suffice to prove that $N/c$~is composite.
% This case is less frequent than the “early” case;
% it happens with probability
% asymptotically equivalent to~$\frac{0.56}{\log \log p}$,
% and in a few percent of cases for cryptographic sizes.
% % expérimentalement, 0.56/log B où B = le plus grand ℓ
% % calcul douteux -> 0.56/log log p, soit 11% pour 2^256.
% 
% \smallskip
% 
% In both cases, it is possible to produce a certificate of composition
% of the curve order in the following form: $(n, G, Π)$,
% where $n$~is a composite number coprime to the cofactor,
% $Π$~is a proof of composition of~$n$,
% and $G$~is a point of the curve such that~$n· G = 0$.
% Namely, in the “early” case, since we know a point~$G$ such that~$ℓ G = 0$,
% we may output the certificate~$(2 ℓ, G, Π)$
% where $Π$~is a certificate of composition of~$2 ℓ$.
% In all cases, the full certificate has size~$O(\log p)$.
% If $N ≡ 0 \pmod{ℓ}$, then the certificate of composition
% is verifiable using~$O(\log ℓ) = O(\log \log p)$ operations in the base field;
% else, $O(\log p)$~operations are needed.

\subsubsection{Adequate curve order}

When the algorithm finds that the value~$N$ is prime
or only includes the allowed small cofactor $c$,
a certificate is as follows: $(N/c, G, Π)$,
where $N$~is the number of points, $c$~is the expected cofactor,
$G$~is a point of order~$N/c$
(for example, any random non-zero point if $c = 1$ and $N$ is prime),
and $Π$~is a proof of primality of~$N/c$
(which may be left empty if $N/c$~is small enough
that proving its primality directly is easier than using a certificate).
The validation program then checks that $G ≠ 0$,
$(N/c) · G = 0$, adequate points of small order exist for the cofactor $c$
(as $c$ is expected to be very small, this is a cheap operation),
and~$N ≥ (√p-1)^2$.
If this is the case, then $N$~is the curve order.

For the sizes involved in elliptic curve cryptography,
proving the primality is practical using a test such as
the APR-CL test~\cite{fcs1980adleman,mc1984cl}.
In the case where the validation program runs under strong contraints,
it is also possible to write a primality certificate
in a form such as ECPP~\cite{mc1993am},
which has a reasonable size~($O(\log^2 p)$ bits)
and is verifiable in a short time~($O(\log^2 p)$ field operations).

We expect that all curve orders including more than the expected cofactor $c$
will be rejected by a pseudoprimality test such as the Miller-Rabin test.
Therefore, the generating program will have to run the primality proof
only once, for the last curve.

\subsubsection{Refreshing the base field}

We saw in paragraph~\ref{sss:twist} that the rarity of
secure and twist-secure elliptic curves depends on the
cardinality of the base field,
with a variation of a factor~$≈ 10$ for a given size of prime numbers.
This means that,
in the case where a pseudo-random base field is preferred,
we suggest that
the sampling function for elliptic curves change the base field
for each new curve, to avoid being stuck at a ``bad'' prime.
This averages out the probabilities
and leads to a speed-up of~$≈ 4$ compared to the worst-case expectation.
This has no apparent security implication
since the final prime number is pseudo-random anyway;
the only performance penalty is the cost of generating new primes,
which is negligible comparde with the cost of computing curve orders.


\subsection{Discriminant and class group}

The fundamental discriminant is given by
the factorization of the discriminant~$D_\phi = t^2 - 4 p$.
While computing this factorization is quite expensive,
(and asymptotically dominates the whole generation process),
it will generally be performed only once, on the final curve,
and validating the factorization is extremely easy.
The same is true for the subsequent computation of the exact endomorphism
ring $\ro O_E$ and its discriminant $\Delta_E$
in case the curve does not have prime order
(recall that if the curve has prime order then $\ro O_E = \ro O_K$
and no additional computation has to be performed).

\smallskip

The sole knowledge of the fundamental discriminant also gives a lower bound
on the class number of the endomorphism field of~$E$
and so on that of its endomorphism ring~$\ro O_E$.
However, this bound is only approximately~$p^{1/4}/\log p$.

In some cases, a better (higher) lower bound~$B$ might be required.
We can prove that the class number is greater than~$B$
in the following simple way:
since the class group is expected to be almost cyclic~\cite{nt1984cl},
it is enough to produce an element~$g$ of order~$≥ B$.
However, checking this requires
computing the $B$ multiples~$g, 2g, …, B g$,
and is therefore exponential.

We do not expect to ever have to prove that a curve was rejected
because its class number is smaller than~$B$.
We know no efficient way to prove such a fact in general.
However, it might be enough to prove
that a few deterministically generated elements of the class group
all have order~$≤ B$:
while this does not prove that~$h ≤ B$,
it proves that the generating program was unable to prove that~$h > B$
and that the curve should therefore be rejected.

\smallskip

The same considerations apply to the smoothness of the class number.
If the class number is not smooth, then
verifying it is a quadratic computation.
If the class number is smooth, then
the generating program cannot prove it,
but it can prove that it was unable to prove that
the class number is not smooth.



% In this case as in the case of the curve order,
% there are potentially two cases to certify:
% namely, either that a curve was rejected because of a bad class group,
% or that the selected curve has a good class group.
% The first case is extremely unlikely to ever happen since
% most elliptic curves have a large class group.

\subsection{Embedding degree}

The embedding degree of~$E$ is the smallest integer~$e$
such that $q$~divides~$p^{e}-1$
(that is the multiplicative order of~$p$ modulo~$q$).
Computing exactly this embedding degree requires factoring~$q-1$
and is an expensive computation.
However, this factorization, which is the only expensive task
in the computation of the embedding degree,
is easy to include in the certificate.
(If one only wants to check that the embedding degree
is larger than a moderate bound $B$,
brute-force might be sufficient.)

We note that the embedding degree of the quadratic twist
is distinct from that of the curve;
therefore, if twist security is required,
then this computation will need to be performed twice.

\subsection{Choice of the sampling function}

The previous algorithms provide, to the best of our knowledge,
a certifiable way to transparently generate a cryptographic elliptic curve
from the input of some conditions and a sampling function.
In the case where the generating function is considered as pseudo-random
and the normality conditions of Section~\ref{ss:normal} are included,
we feel confident that the resulting elliptic curve
will not have any particular weakness.
However, a malicious generating program, given enough computing resources,
might be able to run the generating algorithm
for a large family of seeds of a pseudo-random function
until a suitable elliptic curve is found (see~\cite{badass}).

Even though we think that a curve satisfying the normality conditions
of Section~\ref{ss:normal} will generally be as good as possible
for cryptographic use,
and using a highly constrained seed (such as zero)
would be sufficient in practice,
we could imagine as a supplementary precaution against this manipulation
to first fully specify the generating protocol in all its details,
and to put the seed choice out of reach of the generating entity.
Several examples come to mind.
For example, several entities could contribute to the seed,
each one of them generating its own secret share
and publicly committing it before all shares are revealed.
Another possibility is committing in advance to using
the result of some future, publicly verifiable observation
expected to be out of reach of manipulation,
such as the observation of sunspots,
a public physical random number such as the result of a lottery drawing,
or a number derived from stock market or sports results.

\subsection{A concrete example}

\subsubsection{Certificate format}

We suggest that the certificate should be separated in three parts.

First, a header declares which choices were made:
the sampling function, the seed (if applicable),
as well as the subset of conditions retained from part~\ref{s:criteria}
with the numerical values of these criteria.
The validation program is then able,
upon reading the header and prior to any computation,
to determine if it accepts the included criteria.

The second part of the certificate is the final, “good” curve,
together with a proof for all the criteria.

The last part is the list of sampled curves,
each one accompanied by a proof for its rejection.
The certificate should also include enough information about
the internal state of the sampling function
to be able to retrace its execution.

\subsubsection{A toy example}

We chose the following sampling function as an example
of “pseudo-random” curves.
Starting from a seed~$s$, we define $p$~as the smallest prime greater than~$s$
and $g$~as the smallest generator of the multipliative group~$(ℤ/pℤ)^{×}$.
We then iterate over the curves with~$a = -3$ (\ref{sss:a=-3})
of the form $y^2 = x^3 - 3 x + b$, where $b = g^n$ for~$n = 1, …$,
until a suitable curve is found.%
\footnote{We use powers of~$g$ as a simple way to produce pseudo-random
looking elements of~$(ℤ/pℤ)^{×}$ only for the sake of this toy example.
An actual, working example should of course involve a more robust
pseudo-random number generator.}

We also include the following conditions:
\begin{itemize} \itemsep 0pt \parskip 0pt
\item the discriminant~$2^4·3^3·(4-b^2)$ is non-zero
(\ref{sss:singular});
\item the orders of the curve (\ref{sss:prime}) and of its quadratic twist
(\ref{sss:twist}) are prime;
\item the trace is non-zero (\ref{sss:anomalous});
\item the embedding degree of the curve and of its quadratic twist
(\ref{sss:embedding-degree}) are at least~$p^{1/4} ≈ 7$;
\item the class number (\ref{sss:class-group}) is at least~$p^{1/4}$.
\end{itemize}

As a seed, we use the current year~$2015$.\footnote{%
Note that this seed choice \emph{was} manipulated,
in order to produce a certificate short enough to fit in a few lines.}
The next prime number is~$p = 2017$, and the smallest generator is~$g = 5$.

The resulting certificate, in pseudo-code, is as follows.
(Given the size of the parameters,
all proofs of primality have been left empty).

% Gadget certificate <<<
\begingroup \advance \leftskip 1em \advance \rightskip 1em
\parindent 0pt \sffamily
\def\header#1{\par\goodbreak \textbf{#1}
\vskip -2ex \leavevmode \leaders\vrule height 1pt \hfill \hbox{}
\par}

\header{Header}
sampling.function = \texttt{pseudo-random/powers}\\
sampling.seed = $2015$\\
condition.cofactor = $1$\\
condition.twist\_prime = \texttt{True}\\
condition.embedding\_degree = $7$\\
condition.twist\_embedding\_degree = $7$\\
condition.class\_number = $7$

\header{Curve}
$(2017, -3, 625)$\\
order = $2063$, point = $(0, 25)$\\
twist\_order = $1973$\\
disc\_factors = $\acco{6043}$\\
class\_number = $9$, form = $(17,3,89)$\\
embedding\_degree = $1031$, factors = $\acco{2, 1031}$\\
twist\_embedding\_degree = $493$, factors = $\acco{2, 17, 29}$

\header{Rejected curves}
($(2017, -3, 5)$, composite, $2065$, witness, $1679$,
  point, $(1,258)$)\\
($(2017, -3, 25)$, torsion\_point, 3, point, $(448, 288)$)\\
($(2017, -3, 125)$, torsion\_point, 2, point, $(982, 0)$)

\endgroup%>>>

\section*{Conclusion and suggestions}

Some of the publicly announced elliptic curves,
are provably sampled, in a way conforming to the presentation
sketched out in Section~\ref{s:certif}.
This is the case of the Brainpool family,
where the sampling function generates
curves defined over pseudo-random prime fields,
with pseudo-random coefficients,
with the slight reservation that the generating process does not include
the condition that the order of the quadratic twist be
prime~(\ref{sss:twist}).
This is also the case of some curves with small coefficients,
where the sampling function generates the coefficients
in increasing order.
However, since these curves are, by construction,
defined over special prime fields
and since they also have small coefficients,
they may be threatened in the sense of Section~\ref{ss:side}
and exceptional in the sense of Section~\ref{ss:normal}.
Moreover, most of these curves
also have a cofactor strictly greater than one.

\bigbreak

We therefore point out that, to our knowledge,
there does not exist yet any public proposal of an elliptic curve,
or of a family of elliptic curves, conforming both
to the provable generation of Section~\ref{s:certif}
and to the maximal security criteria of Section~\ref{s:criteria}
and in particular of~\ref{ss:dlp}, \ref{ss:side} and~\ref{ss:normal},
\emph{i.e.} with pseudo-random coefficients
modulo a pseudo-random prime,
with a secure twist,
and with a cofactor equal to one.

\bibliographystyle{plain}
\bibliography{contrib}
%\end{multicols}

\end{document}
