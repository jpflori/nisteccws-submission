\documentclass{article}
\usepackage[margin=20mm]{geometry}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{unicode}
\usepackage{multicol}

\def\F{\mathbb{F}}
\let\ro\mathcal
\let\fr\mathfrak
\def\abs#1{\left|#1\right|}
\def\pa#1{\left(#1\right)}
\DeclareMathOperator\End{End}
\DeclareMathOperator\Cl{Cl}

\usepackage{xcolor}
\def\XXX{{\colorbox{red}{{\color{white}\bfseries XXX}}}}

\begin{document}
% \begin{multicols}{1}
\sloppy

\XXX TODO:

exemples Microsoft MSR ECLIB, Curve25519, ...

\section{Criteria for cryptographic elliptic curves}
\label{s:criteria}

%<<<2
We give here a list of useful criteria for selecting elliptic curves
for general cryptographic use.
We sort these conditions in several categories,
with different importance being granted to each category.
The first category~(\ref{ss:dlp}) contains the minimal conditions under which
the discrete logarithm problem may be hard in the point group.
The second category~(\ref{ss:side}) describes some properties that improve
the resistance of the curve to some common side-channel attacks.
The third one~(\ref{ss:normal}) is not related to any known attack;
instead, it gives condition under which a curve may be considered
as particular and therefore maybe particularly vulnerable
to some yet-unknown attack.
Finally, the last two categories group some properties
which may be desirable about the curve,
either for facilitating its implementation
or for specific protocols and algorithms,
without weakening too much its security.

In all the remainder of this section,
we shall use the following notations:
$p ≥ 5$~is a prime number,
$k = \F_{p}$ is the finite field with $p$~elements,
$E: y^2 = x^3 + a\,x + b$~is an elliptic curve defined over~$k$,
$N = \abs{E(\F_p)}$~is the order of the group of rational points of~$E$,
$t = p + 1 - N$~is the trace of the Frobenius automorphism of~$E$,
and $q$~is the largest prime divisor of~$N$.

%>>>2

\subsection{Hardness of the discrete logarithm problem}
\label{ss:dlp}

We give here a list of conditions corresponding to
known attacks on the discrete logarithm problems.
We point out that some criteria commonly required
for generating elliptic curves,
such as the criteria on the discriminant and class number~\cite{rfc5639},
are not known to lead to a direct attack.
Therefore, we included those criteria
in the “normality” section (\ref{ss:normal}) below.
for elliptic curves
such as the criteria about the discriminant and class number

\XXX pollard rho petit discriminant

\XXX trap Weil descent

\subsubsection{Nonsingular curve}

If the discriminant~$4\, a^3 + 27\,b^2$
of the curve~$E$ is zero, then $E$~is not an elliptic curve:
it is a singular curve and its group of points is isomorphic to
an additive or multiplicative group.

\subsubsection{Large prime subgroup}

Since discrete logarithms are computable in the group~$E(k)$
with complexity~$O(√q)$, where $q$~is the largest prime divisor of~$N$,
it is necessary that~$√q$ attains the required security bound.
In practice, it is advisable to select elliptic curves whose order~$N$
is the product of a large prime~$q$
and a very small \emph{cofactor}~$N/q$.
A cofactor $1$ yields an optimal security for a given bitsize
whereas a very small cofactor might allow performance improvements.

For a given curve~$E$, checking if this is the case
requires computing the group order~$N$,
which is a moderately expensive task.
For curves over large prime field, the most efficient algorithms are variations
of the SEA algorithm~\cite{smf2008cl} with complexity~$O(\log(q)^4)$.

The probability that a random elliptic curve over~$\F_p$
has a prime group order is bounded below~\cite{lms2000gm}
by $\frac{0.44}{\log p}$.

This condition is the most restrictive in practical use.

\XXX complexité

\subsubsection{Absence of additive transfer}

If $N = p$ then there exists an \emph{additive transfer}
reducing the discrete logarithm in~$E(k)$
to that in the additive group of~$\F_p$.
Therefore, elliptic curves with trace~$1$ must be excluded.

\subsubsection{Absence of multiplicative transfer}

The \emph{embedding degree} is the smallest integer~$e$ such that
$q$~divides~$p^e -1$.
The pairing attached to the elliptic curve~$E$
gives a group homorphism from~$E(k)$
to the multiplicative group~$\F_{p^e}^{×}$.

Therefore, elliptic curves with an embedding degree small enough
that discrete logarithms are computable in $\F_{p^e}^{×}$
must be excluded.

Over the base field~$\F_p$, the supersingular curves
are exactly the curves with trace zero,
which have an embedding degree~one.

\subsubsection{XEDNI}

+ Slides ECC 2001 avec trappage de courbe Silverman

\subsection{Resistance to common side-channel attacks}
\label{ss:side}

While the existence of side-channel attacks
mainly depends upon the implementation of the curve,
in some circumstances the choice of the curve itself
might have an impact on the effiency of these attacks
or on the ease of implementation of appropriate counter-measures.

\subsubsection{Twist security}
\label{sss:twist}

The \emph{quadratic twist} of the elliptic curve~$E$
is the curve~$E'$ with equation~$d y^2 = x^3 + a\,x + b$,
where $d$~is a non-square element of~$k$.
For a given abscissa~$x_0$,
exactly one of the curves~$E, E'$ contains a point~$(x_0, y)$.

An attacker may manipulate a badly written implementation
into using the quadratic twist~$E'$
in place of the original curve~$E$,
either through side-channel attacks~\cite{fdtc2008flrv},
or through attacks on a badly designed protocol.

Such attacks may be easily mitigated by checking
that the manipulated points are on the original curve~$E$
and not on its twist~$E'$.
A supplementary layer of protection against these attacks
can be obtained if the twist~$E'$ satisfy
similar security conditions as the curve~$E$ itself.
Nevertheless, it should be noted that the original curve and
its twist will never share the same exact behavior against
side-channel attacks, e.g. exactly one of the two curves the coefficient $b$
will be a square which is unoptimal against side channel attacks
as the curve will contain a special point of the form~$(0, y)$.
Moreover twist security won't protect against potential side channel attacks
where one would detect if the computation took place on the curve or its twist
and gain information on some bits of the secret.

Using a variant of the technique of Galbraith and McKee~\cite{lms2000gm},
we find that the probability that a random elliptic curve on~$\F_p$
is both secure and twist-secure
is bounded below by $\frac{0.2}{\log^2 p}$.
This probability means that
including twist-security in the conditions is particularly expensive,
since all necessary checks will be performed on
a quadratic (in $\log p$) number of elliptic curves.
In particular, in view of
the certificates mentioned in section~\ref{s:certif},
both the size and the cost of validation of the certificate
increase by a linear factor.
Although this property of twist-security is quite rare,
the curves satisfying it are not special
in the sense of section~\ref{ss:normal}.

\subsubsection{Special points}
\label{sss:special-points}

The \emph{special points} of an elliptic curve
are the points~$(x,y)$ such that one of the two coordinates is zero.
In the presence of such special points,
there exist side-channel attacks~\cite{pkc2003goubin}
exposing private information.

Several protections against these attacks exist \XXX.
One of them is simply ensuring that the curve does not contain
any special point.

Special points of the form~$(x, 0)$ exist if the curve has
an even order.
Special points of the form~$(0, y)$ exist if the coefficient~$b$
is a square in~$k$.

\subsubsection{Special base field}
\label{sss:special-side}

\XXX

\subsubsection{Unified group law}
\label{sss:unified}

\XXX

\subsection{Normality of the curve}
\label{ss:normal}

The criteria we present here do not correspond to
known attacks on elliptic curves.
Rather, they are properties that random curves should verify
with overwhelming probability.
When generating curves, checking for these conditions
should reject a negligible proportion of curves.
If on the other hand a curve does not satisfy one of these conditions
then, even though we do not know any precise attack,
this curve is slightly more likely to be vulnerable.

More concretely this means that during the process of generating
a secure curve, in general curves will only be discarded
because they don't very the efficiently checked criteria
of the previous sections.
When a curve passes the latter, the computations needed
for the criteria of this section will be performed and
will also pass with overwhelming probability.
Therefore, these computations will only be performed once
on the final curve in general.

Many common number-theoretic computations depend on
the factorization of a parameter (for example, the order of some group),
and become easier when this parameter is smooth
(\emph{i.e.} when it has only small prime divisors).
We recall here~\cite{jnt1983cep} that the probability that
a number~$n$ be~$B$-smooth is approximately~$u^{-u}$,
where $u ≃ \log n / \log B$.

We must determine a threshold at which the factorization of these
numbers is considered ``too smooth''.
The first choice for a probability threshold would be
of the order of~$1/√p$, corresponding to the complexity of
the discrete logarithm in the group~$E(k)$.
% For example, for a fixed exponent~$α$,
% a number~$x ≈ p^{α}$ only has a probability~$≈ 1/√p$
% of being~$(\frac{\log p}{2\log\log p})^{2α}$-smooth.
However, numeric computations suggest that this choice may be too lenient:
for random numbers of 256~bits, the threshold probability of~$2^{-128}$
corresponds to numbers which are~$727$-smooth.
In a computational view, this bound is extremely low:
any algorithm involving polynomials or matrices of this size
would be easy to implement.
We instead use the smoothness bound~$B = p^{1/4}$,
corresponding to a probability of~$1/256$.
This means that we expect that $1/256$~of pseudo-random elliptic curves
will be rejected as ``too exceptional'',
while any variant of index calculus in these groups
will involve matrices of size about~$p^{1/4}$,
which is possible to keep out of reach for reasonable values of~$p$.

% We could instead balance the smoothness bound~$B = n^{1/u}$
% such that the probability of smoothness~$u^{-u}$ is~$1/B$.
% Using this estimate,
% we could say that
% a random number of $256$~bits should not be $2^{28}$-smooth
% and that a random number of $512$~bits should not be $2^{42}$-smooth.
% We think that more research is needed on this subject.

\subsubsection{Cardinality of the quadratic twist}
\label{sss:twist-smooth}

The order of the quadratic twist of~$E$ is~$2(p+1) - n$.

We recall from paragraph~\ref{sss:twist} above
that the smoothness of this number may have a direct influence
on the efficacity of some side-channel attacks.

\XXX

\subsubsection{Discriminant of the endomorphism ring}
\label{sss:discriminant}

The \emph{endomorphism field} of the curve~$E$
is the field~$K$ generated by its Frobenius endomorphism~$φ$.
Since $φ$~is a root of the equation~$φ^2 - t φ + p = 0$,
$K$~is an imaginary quadratic number field.
The discriminant of~$φ$ is the value~$D = t^2 - 4 p < 0$;
the discriminant of~$K$ is the fundamental discriminant~$D_K$
such that~$D = D_K f^2$ for~$f ∈ ℤ$.

The expected value for~$D_K$ is~$D_K ≈ D$;
we know~\cite{jis2014cdkd} that the square-free part of
a random integer~$n$ is less than~$√n$
with probability approximately~$1.66/√n$.
For cryptographic sizes, this means that,
with overwhelming probability, we should expect~$D_K > √D$.

The best method we know to compute~$D_K$ requires the
factorization of~$D$.
For cryptographic values of~$D$, this is a possible but
quite expensive task.
However, since almost all curves satisfy the condition~$D_K > √D$,
this condition is extremely unlikely to lead to the rejection of a curve
and the computation will therefore be performed only once in practice.
Moreover, once the factorization of~$D$ is known,
it is very easy to check again.

\subsubsection{Class number and class group}

% If the number of points of~$E$ is prime,
% then its endomorphism ring is the maximal order~$\ro O_K$ of~$K$.
% preuve:
% sinon, il existe deux courbes isogènes ψ: E → E' ayant des anneaux
% d'endomorphismes distincts. Par conséquent, il existe un nombre premier
% ℓ≠N divisant f'/f (ou f/f' si on veut). L'isogénie ψ est donc
% (non_horizontale) sur le ℓ-volcan. Par conséquent, elle modifie la
% structure de groupe de E(k) ⊗ ℤ_ℓ, i.e. son noyau contient un groupe
% d'ordre ℓ. Or, puisque N est premier, E(k) ne contient aucun tel
% sous-groupe. ⚡
The class number~$h(K)$ of the maximal order~$\ro O_K$
is the minimal degree of a number field
over which $E$~admits a faithful lift.
It is also the degree of the Hilbert class polynomial
used in the theory of complex multiplication.
Therefore, a large class number may prevent the use
of any attacks based on complex multiplication.
Under the generalized Riemann hypothesis,
the best method we know to compute the class number
is subexponential~\cite{chile2009biasse},
and requires at least a few days of computation for cryptographic sizes.
Since this method also computes the group stucture
of the ideal class group of~$\ro O_K$,
it can be used to produce a small and easily verifiable certificate
for the class number.
% It is related to the class number~$h(\ro O_K)$ of the maximal order
% by a simple formula~\cite[7.24]{cox1989primes}:
% if $R$~is the order of conductor~$f$, then
% $h(R) = h(\ro O_K) f ∏ (1 - \pa{\frac{D_K}{p}}/p)$
On the other hand,
the class number of~$K$ is minorated~\cite{cras1990louboutin},
under the generalized Riemann hypothesis,
by~$h(K) ≥ \frac{π}{3e} \frac{√{\abs{D_K}}}{\log \abs{D_K}}$.

\medbreak

The class number has a negligible probability
of being~$(\log p)^{1-o(1)}$-smooth.
While the best known algorithms for computing the class number
are sub-exponential~\cite{chile2009biasse},
for a polynomial bound~$B$,
it is possible to prove that $h$~is not $B$-smooth
in time~$O(B \log p)$, which is polynomial.
% it is possible to prove in polynomial time that $h$~is not $B$-smooth in polynomial time.
% Namely, for each prime~$ℓ < B$, let~$e(ℓ)$ be
% the smallest integer such that~$ℓ^{e(ℓ)} > h$;
% and define~$M$ as the product of all~$ℓ^{e(ℓ)}$.
% Since~$h = O(√p)$, we see that~$\log M ≈ \frac{B}{2 \log B} \log p$.
% If $h$~is $B$-smooth, then all elements of the class group~$\Cl K$
% have $M$-torsion.
% Therefore, any element~$g$ of the class group such that~$M g ≠ 0$
% proves that $h$~is not $B$-smooth.
% Since we expect that $\Cl K$~is almost cyclic,
% in general we need to check this for only one element~$g$.
% The number of multiplications required in~$\Cl K$
% is approximately~$\log M ≈ O(\log^2 p)$.


\subsubsection{Special base field}
\label{sss:special-anormal}

In the case of the \emph{multiplicative} discrete logarithm problem,
the Special Number Field Sieve allows faster computations
of discrete logarithms modulo~$p$
when $p$~is a \emph{special} prime number,
\emph{i.e.} when it is a value of a polynomial of low degree
with small coefficients evaluated at a small value.

It is hard to check whether a given (prime) number is special.
However, most prime numbers used in standard elliptic curves
(for example in the FIPS 186--2 curves \XXX or in Curve25519)
are explictly given as special primes as these allow faster arithmetic
over the base field.
Even though we don't know any attack against curves with such special
parameters, it is legitimate to consider them as special.

A related question would be to detect curves whose number of points $N$
is a special number.
As noted above, this cannot be easily check.
Nonetheless, the only way we are aware of which could lead to the construction
of such a curve would be through the use of complex multiplication.
Therefore, the discriminant of the number field associated
to the generated curve would be unusually small and this would be detected by
other checks from this section.

\subsubsection{Embedding degree}

For any bound~$m$, the probability that
the embedding degree of~$E$ is at most~$m$
is~\cite{jcrypto1998bk} $O(m^2 · p^{-1}·(\log p)^5·(\log\log p)^2)$.
This implies that, with probability~$1 - 1/√p$,
the embedding degree of~$E$ is at least~$p^{1/4 - o(1)}$.

\subsubsection{Multiplicative group of the base field}

The multiplicative structure of the base field~$\F_p^{×}$
is directly related to the factorization of~$p-1$.
In particular, if $p-1$~is smooth
(\emph{i.e.} all its prime divisors are small),
then the multiplicative discrete logarithm problem is easy.
Let~$B$ be a smoothness bound: then, with~$u = \log p / \log B$,
$(p-1)$~is $B$-smooth with probability~$≈ u^{-u}$~\cite{jnt1983cep}.
This means that, with overwhelming probability,
$(p-1)$~has at least one prime divisor greater than~$(\log p)^2$.

\subsection{Convenience of implementation}
\label{ss:convenience}

We list here a few criteria that
may make the implementation of an elliptic curve more convenient
without weakening the security.
In order to not weaken the ``normality'' of the curves,
we consider only these conditions which are satisfied
by an asymptotically non-zero proportion of all elliptic curves.

\subsubsection{Fast Jacobian coordinates}

Choosing a curve of the form~$y^2 = x^3 - 3 x + b$ (that is with $a=-3$)
enables to save 2 out of 10 multiplications~\cite{ieeep1363}
required to double a point in Jacobian coordinates.
A random elliptic curve over~$\F_p$
is isomorphic to a curve with~$a = -3$
with probability~$1/2$ if~$p ≡ 3 \pmod{4}$ and~$1/4$ if~$p ≡ 1 \pmod{4}$.

\subsubsection{Number of points at most~$p$}

If the number of points~$N$ is greater than~$p$,
then it might be impossible to represent numbers up to~$N-1$
in the same memory size as coordinates of points of~$E$.
Exactly one half of all curves satisfy this.

\subsubsection{Easy computation of square roots}

The \emph{point compression} method allows representing
one point~$(x,y)$ of~$E$ by only its abscissa~$x$ and
one bit discriminating between the two possible values~$±y$.
However, recovering~$y$ requires computing a square root in~$k$.
This is easier when~$p ≡ 3 \pmod{4}$ since
in this case, $c^{(p+1)/4}$~is a square root of~$c$ if $c$~is a square.

\subsubsection{Equations other than Weierstraß}

There exist several other representations of elliptic curves
than Weierstrass curves, such as
Edwards curves~\cite{ams2007edwards},
twisted Edwards curves~\cite{africa2008bbjl},
Jacobi curves~\cite{aaaaec2003bj},
and Montgomery curves~\cite{mathcomp1987montgomery}.
Only a finite proportion of curves are isomorphic
to a curve in these families.
For example, about~$35\%$ of all elliptic curves
are isomorphic to a twisted Edwards curve,
and about~$40\%$ are isomorphic to a Montgomery curve.
% source: own research
\XXX source (own research!)

Each of these families requires at least
the presence of a point of order two on the curve.
This is a special point in the sense of~\ref{sss:special-points} above
and could introduce a weakness in some contexts.
Moreover, in the case of a non-prime base field,
there exist some attacks~\cite{jcrypto2014fghr}
against several of these curve families
which somewhat weaken the discrete logarithm problem.

\XXX pollard rho accéléré ?

\subsubsection{Fast base field arithmetic}
\label{sss:special-fast}

\XXX nombres premiers spéciaux

\subsubsection{Small coefficients}

\XXX

\subsection{Families of curves with particular properties}
\label{ss:particular}

We give here a short list of families of curves
with particular properties which may be useful in some specific contexts.
These families are small enough
to contradict the ``normality'' conditions of section~\ref{ss:normal}.

\subsubsection{Curves for pairing-based cryptography}

\subsubsection{Curves with a fast endomorphism}


\section{Transparent generation of curves}
\label{s:certif}

We give here the outlines of a certificate format
proving that a given curve was generated by a public algorithm
from a known seed.

\subsection{Generating an elliptic curve}

This procedure is in two steps.
First, a \emph{generating program} determines a suitable elliptic curve.
This programs outputs the elliptic curve
together with a \emph{certificate} proving that
the curve is actually suitable for cryptographic purposes.
Moreover, the certificate should also prove that
none of the curves previously tried by the generating program
was suitable.
Then, a \emph{validation program} can use the certificate data
to validate the generating process.
The certificate enables this second program
to have a significantly shorter runtime than the first one.

The list of conditions to be checked and the way to iterate
curves parameters would be indicated in the certificate header.
We do not fully specify how every condition presented
in the previous sections should be written down in the
certificate when it lead to the rejection of a curve.
For most of the ones presented in Section~\ref{s:criteria},
checking whether a curve is suitable is very fast
and producing dat.
However, two conditions in particular are more expensive:
namely, the condition that the curve order is prime
(this condition is expected to be the one condition
leading to rejection of all the unsuitable curves,
so that this check will be performed a large number of times),
and the computation of the class number
(which will typically be performed only once, for the final curve).

\subsection{Certifying the curve order}

\XXX composite souvent, prime une fois

\subsubsection{Composite curve order}

Over a prime base field,
the most efficient methods to compute the curve order are
variants of the $ℓ$-adic SEA algorithm~\cite{mathcomp1985schoof,
jtnb1995schoof}.
This algorithm computes the order~$N$ of the curve
by computing $N \pmod{ℓ}$ for several
auxiliary primes~$ℓ < O(\log p)$.
The fact that $N$~is composite may therefore be detected
either in an early step,
when there exists~$ℓ$ such that $N ≡ 0 \pmod{ℓ}$,
or at the end of the computation,
when we find that the computed value~$N$ is composite.

In the “early” case,
the counting algorithm finds a polynomial~$f$, of degree~$(ℓ-1)/2$,
whose roots are the abscissae of $ℓ$-torsion points of~$E$.
We may then recover one of these points by
computing one factor of~$f$ of degree~$1$:
using the Cantor-Zassenhaus polynomial factorization algorithm,
we find that the complexity of this operation
is approximately the same as that of computing~$N \pmod{ℓ}$,
so that computing this extra information
has a small impact on computation time.

\smallskip

In the other, “late” case, the curve order is not divisible
by any one of the auxiliary primes.
The counting algorithm will then compute the exact value~$N$.
A simple pseudo-random proof of composition,
such as the Miller-Rabin test,
will then suffice to prove that $N$~is composite.
This case is less frequent than the “early” case;
it happens with probability
asymptotically equivalent to~$\frac{C}{\log \log p}$,
and in a few percent of cases for cryptographic sizes.
% calcul douteux -> 0.56/log log p, soit 11% pour 2^256.

\smallskip

In both cases, it is possible to produce a certificate of composition
of the curve order in the following form: $(N, G, Π)$,
where $N$~is a number such that~$N < 2 (√p - 1)^2$,
$Π$~is a proof of composition of~$N$,
and $G$~is a point of the curve such that~$N G = 0$.
Namely, in the “early” case, since we know a point~$G$ such that~$ℓ G = 0$,
we may output the certificate~$(2 ℓ, G, Π)$
where $Π$~is a certificate of composition of~$2 ℓ$.
In all cases, the full certificate has size~$O(\log p)$.
If $N ≡ 0 \pmod{ℓ}$, then the certificate of composition
is verifiable using~$O(\log ℓ) = O(\log \log p)$ operations in the base field;
else, $O(\log p)$~operations are needed.


\subsubsection{Prime curve order}
We expect that all non-prime curve orders
will be rejected by a pseudoprimality test such as the Miller-Rabin test.
Therefore, the generating program will have to run the primality proof
only once, for the last curve.

When the algorithm finds that the value~$N$ is prime,
a certificate is as follows: $(N, G, Π)$,
where $N$~is the number of points,
$G$~is a point of order~$N$ (for example, any random non-zero point),
and $Π$~is a proof of primality of~$N$
(which may be left empty if $p$~is small enough
that proving its primality directly is easier than using a certificate).
The validation program then checks that $G ≠ 0$,
$N · G = 0$, and~$N > (√p+1)^2 / 2$.
If this is the case, then $N$~is the curve order.

For the sizes involved in elliptic curve cryptography,
proving the primality is practical using a test such as
the APR-CL test~\cite{fcs1980adleman,mathcomp1984cl}.
In the case where the validation program runs under strong contraints,
it is also possible to write a primality certificate
in a form such as ECPP~\cite{mathcomp1993am},
which has a reasonable size~($O(\log^2 p)$ bits)
and is verifiable in a short time~($O(\log^2 p)$ field operations).

\subsection{Fundamental discriminant and class group}

The fundamental discriminant is given by
the factorization of the discriminant~$D = t^2 - 4 p$.
While computing this factorization is quite expensive,
(and asymptotically dominates the whole generation process),
it will generally be performed only once, on the final curve,
and validating the factorization is extremely easy.

The knowledge of the fundamental discriminant gives a lower bound
on the class number of the endomorphism field of~$E$.
However, this bound is only approximately~$p^{1/4}/\log p$.

\smallskip

\XXX est-ce vraiment nécessaire ?

In some cases, a better (higher) lower bound~$B$ might be required.
Proving that the class number is greater than~$B$ is simple:
since the class group is expected to be almost cyclic,
it is enough to produce an element~$g$ of order~$≥ B$.
However, checking this requires
computing the $B$ multiples~$g, 2g, …, B g$,
and is therefore exponential.

We do not expect to ever have to prove that a curve was rejected
because its class number is less than~$B$.
We know no efficient way to prove such a fact in general.
However, in this case, it might be enough to prove
that a few deterministically generated elements of the class group
all have order~$≤ B$:
while this does not prove that~$h ≤ B$,
it proves that the generating program was unable to prove that~$h > B$
and that the curve should therefore be rejected.

\smallskip

The same considerations apply to the smoothness of the class number.
If the class number is not smooth, then
verifying it is a quadratic computation.
If the class number is smooth, then
the generating program cannot prove it,
but it can prove that it was unable to prove that
the class number is not smooth.



% In this case as in the case of the curve order,
% there are potentially two cases to certify:
% namely, either that a curve was rejected because of a bad class group,
% or that the selected curve has a good class group.
% The first case is extremely unlikely to ever happen since
% most elliptic curves have a large class group.

\subsection{Choice of the generating function}

The previous algorithms provide, to the best of our knowledge,
a certifiable way to transparently generate a cryptographic elliptic curve
from the input of a seed and a generating function.
In the case where the generating function is considered as pseudo-random
and the normality conditions of section~\ref{ss:normal} are included,
we feel confident that the resulting elliptic curve
will not have any particular weakness.
However, a malicious generating program, given enough computing resources,
might be able to run the generating algorithm
for a large family of seeds of the pseudo-random function
until a suitable elliptic curve is found.

A supplementary condition against this manipulation
would be to put the seed choice out of reach of the generating entity.
Several examples come to mind.
For example, several entities could contribute to the seed,
each one of them generating its own secret share
and publicly committing it before all shares are revealed.
Another possibility is committing in advance to using
the result of some future observation expected to be out of reach,
such as the observation of sunspots
or a number derived from stock market or sports results.

\bibliographystyle{plain}
\bibliography{contrib}
% \end{multicols}
\end{document}
